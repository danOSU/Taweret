<!DOCTYPE html>
<html class="writer-html5" lang="python" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Taweret.mix namespace &mdash; Taweret 0.1.0 documentation</title>
      <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Taweret.models namespace" href="Taweret.models.html" />
    <link rel="prev" title="Taweret.core namespace" href="Taweret.core.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> Taweret
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">About Taweret:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="intro.html">Taweret for Bayesian Model Mixing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Instalation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="instalation.html">Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API Documentation:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="modules.html">Taweret</a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="Taweret.html">Taweret package</a><ul class="current">
<li class="toctree-l3 current"><a class="reference internal" href="Taweret.html#subpackages">Subpackages</a><ul class="current">
<li class="toctree-l4"><a class="reference internal" href="Taweret.core.html">Taweret.core namespace</a></li>
<li class="toctree-l4 current"><a class="current reference internal" href="#">Taweret.mix namespace</a></li>
<li class="toctree-l4"><a class="reference internal" href="Taweret.models.html">Taweret.models namespace</a></li>
<li class="toctree-l4"><a class="reference internal" href="Taweret.sampler.html">Taweret.sampler namespace</a></li>
<li class="toctree-l4"><a class="reference internal" href="Taweret.utils.html">Taweret.utils namespace</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="Taweret.html#module-Taweret">Module contents</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Examples:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="notebooks/Linear_BMM_with_step_function_for_SAMBA_models.html">Linear Bivariate BMM with SAMBA toy models : step mixing</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/Linear_BMM_with_cdf_function_for_SAMBA_models.html">Linear Bivariate BMM with SAMBA toy models : cdf mixing</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/Linear_BMM_with_switchcos_function_for_SAMBA_models.html">Linear Bivariate BMM with SAMBA toy models : switchcos mixing</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/Linear_BMM_with_cdf_function_for_coleman_models.html">Linear Bivariate BMM with calibration of Coleman toy models.</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/Bivariate_Test.html">Bivariate BMM Test: Taweret v.0.1.0</a></li>
<li class="toctree-l1"><a class="reference internal" href="notebooks/N_Model_BMM.html">“Bivariate” BMM for n = 3, …, N models</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">For Developers:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="how_to_add_new_mixing.html">How to add a new mixing method to Taweret</a></li>
<li class="toctree-l1"><a class="reference internal" href="how_to_add_documentation.html">How to update documentation in Taweret website</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">Taweret</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a></li>
          <li class="breadcrumb-item"><a href="modules.html">Taweret</a></li>
          <li class="breadcrumb-item"><a href="Taweret.html">Taweret package</a></li>
      <li class="breadcrumb-item active">Taweret.mix namespace</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/Taweret.mix.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="module-Taweret.mix">
<span id="taweret-mix-namespace"></span><h1>Taweret.mix namespace<a class="headerlink" href="#module-Taweret.mix" title="Permalink to this heading"></a></h1>
<section id="module-Taweret.mix.bivariate_linear">
<span id="submodules"></span><h2>Submodules<a class="headerlink" href="#module-Taweret.mix.bivariate_linear" title="Permalink to this heading"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="Taweret.mix.bivariate_linear.BivariateLinear">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Taweret.mix.bivariate_linear.</span></span><span class="sig-name descname"><span class="pre">BivariateLinear</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">models_dic</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'sigmoid'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">nargs_model_dic</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Taweret/mix/bivariate_linear.html#BivariateLinear"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Taweret.mix.bivariate_linear.BivariateLinear" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="Taweret.core.html#Taweret.core.base_mixer.BaseMixer" title="Taweret.core.base_mixer.BaseMixer"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseMixer</span></code></a></p>
<p>Local linear likelihood mixing of two models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>models_dic</strong> (<em>dictionary {'name1' : model1</em><em>, </em><em>'name2' : model2}</em>) -- Two models to mix, each must be derived from the base_model.</p></li>
<li><p><strong>method</strong> (<em>str</em>) -- mixing function</p></li>
<li><p><strong>nargs_model_dic</strong> (<em>dictionary {'name1' : N_model1</em><em>, </em><em>'name2' : N_model2}</em>) -- number of free parameters in each model</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="Taweret.mix.bivariate_linear.BivariateLinear.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mixture_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[]</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Taweret/mix/bivariate_linear.html#BivariateLinear.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Taweret.mix.bivariate_linear.BivariateLinear.evaluate" title="Permalink to this definition"></a></dt>
<dd><p>Evaluvate the mixed model for given parameters at input values x</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mixture_params</strong> (<em>np.1darray</em>) -- parameter values that fix the shape of mixing function</p></li>
<li><p><strong>x</strong> (<em>np.1daray</em>) -- input parameter values array</p></li>
<li><p><strong>model_params</strong> (<em>list</em><em>[</em><em>np.1darray</em><em>]</em>) -- list of parameter values for each model</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>evaluation</strong> -- the evaluation of the mixed model at input values x</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.1darray</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Taweret.mix.bivariate_linear.BivariateLinear.evaluate_weights">
<span class="sig-name descname"><span class="pre">evaluate_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mixture_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Taweret/mix/bivariate_linear.html#BivariateLinear.evaluate_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Taweret.mix.bivariate_linear.BivariateLinear.evaluate_weights" title="Permalink to this definition"></a></dt>
<dd><p>return the mixing function values at the input parameter values x</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mixture_params</strong> (<em>np.1darray</em>) -- parameter values that fix the shape of mixing function</p></li>
<li><p><strong>x</strong> (<em>np.1darray</em>) -- input parameter values</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>weights</strong> -- weights for model 1 and model 2 at input values x</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>list[np.1darray, np.1darray]</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="Taweret.mix.bivariate_linear.BivariateLinear.map">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">map</span></span><a class="headerlink" href="#Taweret.mix.bivariate_linear.BivariateLinear.map" title="Permalink to this definition"></a></dt>
<dd><p>Stores the MAP values for the posterior distributions and is set
during the self.train step</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Taweret.mix.bivariate_linear.BivariateLinear.mix_loglikelihood">
<span class="sig-name descname"><span class="pre">mix_loglikelihood</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">mixture_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">model_param</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_exp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_exp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_err</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">float</span></span></span><a class="reference internal" href="_modules/Taweret/mix/bivariate_linear.html#BivariateLinear.mix_loglikelihood"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Taweret.mix.bivariate_linear.BivariateLinear.mix_loglikelihood" title="Permalink to this definition"></a></dt>
<dd><p>log likelihood of the mixed model given the mixing function parameters
:param mixture_params: parameter values that fix the shape of mixing function
:type mixture_params: np.1darray
:param model_1_param: parameter values in the model 1
:type model_1_param: np.1darray
:param model_2_param: parameter values  in the model 2
:type model_2_param: np.1darray</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="Taweret.mix.bivariate_linear.BivariateLinear.posterior">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">posterior</span></span><a class="headerlink" href="#Taweret.mix.bivariate_linear.BivariateLinear.posterior" title="Permalink to this definition"></a></dt>
<dd><p>Stores the most recent posteriors from running self.train function</p>
<dl class="simple">
<dt>_posterior<span class="classifier">np.ndarray</span></dt><dd><p>posterior from learning the weights</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Taweret.mix.bivariate_linear.BivariateLinear.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CI</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[5,</span> <span class="pre">95]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Taweret/mix/bivariate_linear.html#BivariateLinear.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Taweret.mix.bivariate_linear.BivariateLinear.predict" title="Permalink to this definition"></a></dt>
<dd><p>Evaluate posterior to make prediction at test points x.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.1darray</em>) -- input parameter values</p></li>
<li><p><strong>CI</strong> (<em>list</em>) -- confidence intervals as percentages</p></li>
<li><p><strong>samples</strong> (<em>np.ndarray</em>) -- If samples are given use that instead of posterior                for predictions.</p></li>
<li><p><strong>Returns</strong> -- </p></li>
<li><p><strong>--------</strong> -- </p></li>
<li><p><strong>evaluated_posterior</strong> (<em>np.ndarray</em>) -- array of posterior predictive distribution evaluated at provided
test points</p></li>
<li><p><strong>mean</strong> (<em>np.ndarray</em>) -- average mixed model value at each provided test points</p></li>
<li><p><strong>credible_intervals</strong> (<em>np.ndarray</em>) -- intervals corresponding for 60%, 90% credible intervals</p></li>
<li><p><strong>std_dev</strong> (<em>np.ndarray</em>) -- sample standard deviation of mixed model output at provided test
points</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Taweret.mix.bivariate_linear.BivariateLinear.predict_weights">
<span class="sig-name descname"><span class="pre">predict_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CI</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[5,</span> <span class="pre">95]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">samples</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Taweret/mix/bivariate_linear.html#BivariateLinear.predict_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Taweret.mix.bivariate_linear.BivariateLinear.predict_weights" title="Permalink to this definition"></a></dt>
<dd><p>Calculate posterior predictive distribution for first model weights</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.1darray</em>) -- input parameter values</p></li>
<li><p><strong>CI</strong> (<em>list</em>) -- confidence intervals</p></li>
<li><p><strong>samples</strong> (<em>np.ndarray</em>) -- If samples are given use that instead of posterior                for predictions.</p></li>
<li><p><strong>Returns</strong> -- </p></li>
<li><p><strong>--------</strong> -- </p></li>
<li><p><strong>posterior_weights</strong> (<em>np.ndarray</em>) -- array of posterior predictive distribution of weights</p></li>
<li><p><strong>mean</strong> (<em>np.ndarray</em>) -- average mixed model value at each provided test points</p></li>
<li><p><strong>credible_intervals</strong> (<em>np.ndarray</em>) -- intervals corresponding for 60%, 90% credibl e intervals</p></li>
<li><p><strong>std_dev</strong> (<em>np.ndarray</em>) -- sample standard deviation of mixed model output at provided test
points</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="Taweret.mix.bivariate_linear.BivariateLinear.prior">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">prior</span></span><a class="headerlink" href="#Taweret.mix.bivariate_linear.BivariateLinear.prior" title="Permalink to this definition"></a></dt>
<dd><p>Dictionary of prior distributions. Format should be compatible with
sampler.</p>
<dl class="simple">
<dt>_prior<span class="classifier">Dict[str, Any]</span></dt><dd><p>Underlying prior object(s)</p>
</dd>
</dl>
<p>Please consult <cite>BaseMixer.set_prior</cite> for an example</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Taweret.mix.bivariate_linear.BivariateLinear.prior_predict">
<span class="sig-name descname"><span class="pre">prior_predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">CI</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[5,</span> <span class="pre">95]</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_sample</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Taweret/mix/bivariate_linear.html#BivariateLinear.prior_predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Taweret.mix.bivariate_linear.BivariateLinear.prior_predict" title="Permalink to this definition"></a></dt>
<dd><p>Evaluate prior to make prediction at test points x.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>np.1darray</em>) -- input parameter values</p></li>
<li><p><strong>CI</strong> (<em>list</em>) -- confidence intervals</p></li>
<li><p><strong>n_samples</strong> (<em>int</em>) -- number of samples to evaluvate prior_prediction</p></li>
<li><p><strong>Returns</strong> -- </p></li>
<li><p><strong>--------</strong> -- </p></li>
<li><p><strong>evaluated_prior</strong> (<em>np.ndarray</em>) -- array of prior predictive distribution evaluated at provided
test points</p></li>
<li><p><strong>mean</strong> (<em>np.ndarray</em>) -- average mixed model value at each provided test points</p></li>
<li><p><strong>credible_intervals</strong> (<em>np.ndarray</em>) -- intervals corresponding for 60%, 90% credible intervals</p></li>
<li><p><strong>std_dev</strong> (<em>np.ndarray</em>) -- sample standard deviation of mixed model output at provided test
points</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Taweret.mix.bivariate_linear.BivariateLinear.set_prior">
<span class="sig-name descname"><span class="pre">set_prior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">bilby_prior_dic</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Taweret/mix/bivariate_linear.html#BivariateLinear.set_prior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Taweret.mix.bivariate_linear.BivariateLinear.set_prior" title="Permalink to this definition"></a></dt>
<dd><p>Set prior for the mixing function parameters.
Prior for the model parameters should be defined in each model.</p>
<dl class="simple">
<dt>bilby_prior_dic<span class="classifier">bilby.core.prior.PriorDict</span></dt><dd><dl class="simple">
<dt>The keys should be named as following :</dt><dd><p>'&lt;mix_func_name&gt;_1', '&lt;mix_func_name&gt;_2', ...</p>
</dd>
</dl>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul>
<li><p><em>A full Bilby prior object for the mixed model.</em></p></li>
<li><p><em>Including the mixing function parameters and model parameters.</em></p></li>
<li><p><em>The Bilby prior dictionary has following keys.</em> --</p>
<dl class="simple">
<dt>Prior for mixture function parameter :</dt><dd><p>'&lt;mix_func_name&gt;_1', '&lt;mix_func_name&gt;_2', ...</p>
</dd>
<dt>Prior parameters for model 1 :</dt><dd><p>'&lt;name_of_the_model&gt;_1', '&lt;name_of_the_model&gt;_2' , ...</p>
</dd>
<dt>Prior parameters for model 2 :</dt><dd><p>'&lt;name_of_the_model&gt;_1', '&lt;name_of_the_model&gt;_2' , ...</p>
</dd>
</dl>
</li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Taweret.mix.bivariate_linear.BivariateLinear.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_exp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_exp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y_err</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">label</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'bivariate_mix'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outdir</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'outdir'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">kwargs_for_sampler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Taweret/mix/bivariate_linear.html#BivariateLinear.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Taweret.mix.bivariate_linear.BivariateLinear.train" title="Permalink to this definition"></a></dt>
<dd><p>Run sampler to learn parameters. Method should also create class
members that store the posterior and other diagnostic quantities
important for plotting
MAP values should also caluclate and set as member variable of
class</p>
<dl class="simple">
<dt>result<span class="classifier">bilby posterior object</span></dt><dd><p>object returned by the bilby sampler</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<span class="target" id="module-Taweret.mix.gaussian"></span><dl class="py class">
<dt class="sig sig-object py" id="Taweret.mix.gaussian.Multivariate">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Taweret.mix.gaussian.</span></span><span class="sig-name descname"><span class="pre">Multivariate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">models</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_models</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Taweret/mix/gaussian.html#Multivariate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Taweret.mix.gaussian.Multivariate" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="Taweret.core.html#Taweret.core.base_mixer.BaseMixer" title="Taweret.core.base_mixer.BaseMixer"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseMixer</span></code></a></p>
<blockquote>
<div><p>The multivariate BMM class originally introduced
in the BAND SAMBA package. Combines individual
models using a Gaussian form.</p>
<p>$$ f_{dagger} = mathcal{N} left( sum_i</p>
</div></blockquote>
<p>rac{f_i/v_i}{1/v_i}, sum_i
rac{1}{v_i}
ight) $$</p>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">`python</span>
<span class="pre">m</span> <span class="pre">=</span> <span class="pre">Multivariate(x=np.linspace(),</span> <span class="pre">models=dict(),</span> <span class="pre">n_models=0)</span>
<span class="pre">m.predict(ci=68)</span>
<span class="pre">m.evaluate_weights()</span>
<span class="pre">`</span></code></p>
</div></blockquote>
<dl class="simple">
<dt>x<span class="classifier">numpy.linspace</span></dt><dd><p>Input space variable in which mixing is occurring.</p>
</dd>
</dl>
<p>models : Dict of models with BaseModel methods.</p>
<p>n_models : Number of free parameters per model.</p>
<p>None.</p>
<dl class="py method">
<dt class="sig sig-object py" id="Taweret.mix.gaussian.Multivariate.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Taweret/mix/gaussian.html#Multivariate.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Taweret.mix.gaussian.Multivariate.evaluate" title="Permalink to this definition"></a></dt>
<dd><p>Evaluate the mixed model at one set of parameters.
Not needed for this mixing method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Taweret.mix.gaussian.Multivariate.evaluate_weights">
<span class="sig-name descname"><span class="pre">evaluate_weights</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Taweret/mix/gaussian.html#Multivariate.evaluate_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Taweret.mix.gaussian.Multivariate.evaluate_weights" title="Permalink to this definition"></a></dt>
<dd><p>Calculate the weights for each model in the mixed model
over the input space.</p>
<dl class="simple">
<dt>weights<span class="classifier">numpy.ndarray</span></dt><dd><p>Array of model weights calculated in the
Multivariate.predict function.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="Taweret.mix.gaussian.Multivariate.map">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">map</span></span><a class="headerlink" href="#Taweret.mix.gaussian.Multivariate.map" title="Permalink to this definition"></a></dt>
<dd><p>Return the MAP values of the parameters.
Not needed for this method.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="Taweret.mix.gaussian.Multivariate.posterior">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">posterior</span></span><a class="headerlink" href="#Taweret.mix.gaussian.Multivariate.posterior" title="Permalink to this definition"></a></dt>
<dd><p>Return the posterior of the parameters.
Not needed for this mixing method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Taweret.mix.gaussian.Multivariate.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">68</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Taweret/mix/gaussian.html#Multivariate.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Taweret.mix.gaussian.Multivariate.predict" title="Permalink to this definition"></a></dt>
<dd><p>The f_dagger function responsible for mixing the models together
in a Gaussian way. Based on the first two moments of the
distribution: mean and variance.</p>
<dl class="simple">
<dt>ci<span class="classifier">int, list</span></dt><dd><p>The desired credibility interval(s) (1-sigma, 2-sigma)</p>
</dd>
</dl>
<dl class="simple">
<dt>mean, intervals, std_dev<span class="classifier">The mean, credible intervals, and std_dev</span></dt><dd><p>of the predicted mixed model</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Taweret.mix.gaussian.Multivariate.predict_weights">
<span class="sig-name descname"><span class="pre">predict_weights</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Taweret/mix/gaussian.html#Multivariate.predict_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Taweret.mix.gaussian.Multivariate.predict_weights" title="Permalink to this definition"></a></dt>
<dd><p>Predict the weights of the mixed model. Returns
mean and intervals from the posterior of the
weights.
Not needed for this mixing method.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="Taweret.mix.gaussian.Multivariate.prior">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">prior</span></span><a class="headerlink" href="#Taweret.mix.gaussian.Multivariate.prior" title="Permalink to this definition"></a></dt>
<dd><p>Return the prior of the parameters in the mixing.
Not needed for this method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Taweret.mix.gaussian.Multivariate.prior_predict">
<span class="sig-name descname"><span class="pre">prior_predict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Taweret/mix/gaussian.html#Multivariate.prior_predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Taweret.mix.gaussian.Multivariate.prior_predict" title="Permalink to this definition"></a></dt>
<dd><p>Find the predicted prior distribution.
Not needed for this mixing method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Taweret.mix.gaussian.Multivariate.sample_prior">
<span class="sig-name descname"><span class="pre">sample_prior</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Taweret/mix/gaussian.html#Multivariate.sample_prior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Taweret.mix.gaussian.Multivariate.sample_prior" title="Permalink to this definition"></a></dt>
<dd><p>Returns samples from the prior
distributions for the various weight parameters.
Not needed for this mixing method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Taweret.mix.gaussian.Multivariate.set_prior">
<span class="sig-name descname"><span class="pre">set_prior</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Taweret/mix/gaussian.html#Multivariate.set_prior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Taweret.mix.gaussian.Multivariate.set_prior" title="Permalink to this definition"></a></dt>
<dd><p>Set the priors on the parameters.
Not needed for this mixing method.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Taweret.mix.gaussian.Multivariate.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Taweret/mix/gaussian.html#Multivariate.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Taweret.mix.gaussian.Multivariate.train" title="Permalink to this definition"></a></dt>
<dd><p>Train the mixed model by optimizing the
weights.
Not needed in this mixing method.</p>
</dd></dl>

</dd></dl>

<span class="target" id="module-Taweret.mix.trees"></span><p>Name: trees.py
Author: John Yannotty (<a class="reference external" href="mailto:yannotty&#46;1&#37;&#52;&#48;osu&#46;edu">yannotty<span>&#46;</span>1<span>&#64;</span>osu<span>&#46;</span>edu</a>)
Desc: Defines the tree mixing class, which is an interface for MixBART</p>
<p>Start Date: 10/05/22
Version: 1.0</p>
<dl class="py class">
<dt class="sig sig-object py" id="Taweret.mix.trees.Trees">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">Taweret.mix.trees.</span></span><span class="sig-name descname"><span class="pre">Trees</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">model_dict</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Taweret/mix/trees.html#Trees"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Taweret.mix.trees.Trees" title="Permalink to this definition"></a></dt>
<dd><p>Bases: <a class="reference internal" href="Taweret.core.html#Taweret.core.base_mixer.BaseMixer" title="Taweret.core.base_mixer.BaseMixer"><code class="xref py py-class docutils literal notranslate"><span class="pre">BaseMixer</span></code></a></p>
<dl class="py method">
<dt class="sig sig-object py" id="Taweret.mix.trees.Trees.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Taweret/mix/trees.html#Trees.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Taweret.mix.trees.Trees.evaluate" title="Permalink to this definition"></a></dt>
<dd><p>Calculate a point estimate for mixing model</p>
<dl class="simple">
<dt>evaluation<span class="classifier">float</span></dt><dd><p>point estimate from mixing model</p>
</dd>
</dl>
<p>Global linear mixing:
$$ <a href="#id49"><span class="problematic" id="id50">f_</span></a>mathrm{mixed} = sum_{i=1}^N w_i mathcal M_i(    heta_i) $$</p>
<p><a href="#id1"><span class="problematic" id="id2">``</span></a><a href="#id3"><span class="problematic" id="id4">`</span></a>python
class MyMixer(BaseMixer):</p>
<blockquote>
<div><p>&#64;property
def models(self):</p>
<blockquote>
<div><p>return self._model_list</p>
</div></blockquote>
<p>&#64;models.setter
def model(self, model_list):</p>
<blockquote>
<div><p>self._model_list = model_list</p>
</div></blockquote>
<dl>
<dt>def evaluate(self, weights, model_parameters):</dt><dd><p>value = 0
for i in range(len(self._model_list)):</p>
<blockquote>
<div><p>value += self._model_list[i](x, model_parameters[i])                             * weight[i]</p>
</div></blockquote>
<p>return value</p>
</dd>
</dl>
<p>. . .</p>
</div></blockquote>
<p><a href="#id5"><span class="problematic" id="id6">``</span></a><a href="#id7"><span class="problematic" id="id8">`</span></a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Taweret.mix.trees.Trees.evaluate_weights">
<span class="sig-name descname"><span class="pre">evaluate_weights</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Taweret/mix/trees.html#Trees.evaluate_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Taweret.mix.trees.Trees.evaluate_weights" title="Permalink to this definition"></a></dt>
<dd><p>Calculate or sample a point estimate for model weights</p>
<dl class="simple">
<dt>weights<span class="classifier">np.ndarray</span></dt><dd><p>array of the evaluations or samples of weights</p>
</dd>
</dl>
<p>Global linear mixing:</p>
<p><a href="#id9"><span class="problematic" id="id10">``</span></a><a href="#id11"><span class="problematic" id="id12">`</span></a>python
import scipy</p>
<dl>
<dt>class MyMixer(BaseMixer):</dt><dd><p>. . .</p>
<dl class="simple">
<dt>def evaluate_weights(self, dirichlet_params):</dt><dd><p>return scipy.stats.dirichlet.rvs(dirichlet_params)</p>
</dd>
</dl>
<p>. . .</p>
</dd>
</dl>
<p><a href="#id13"><span class="problematic" id="id14">``</span></a><a href="#id15"><span class="problematic" id="id16">`</span></a></p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="Taweret.mix.trees.Trees.map">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">map</span></span><a class="headerlink" href="#Taweret.mix.trees.Trees.map" title="Permalink to this definition"></a></dt>
<dd><p>Stores the MAP values for the posterior distributions and is set
during the self.train step</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Taweret.mix.trees.Trees.plot_prediction">
<span class="sig-name descname"><span class="pre">plot_prediction</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xdim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Taweret/mix/trees.html#Trees.plot_prediction"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Taweret.mix.trees.Trees.plot_prediction" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Taweret.mix.trees.Trees.plot_sigma">
<span class="sig-name descname"><span class="pre">plot_sigma</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Taweret/mix/trees.html#Trees.plot_sigma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Taweret.mix.trees.Trees.plot_sigma" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Taweret.mix.trees.Trees.plot_weights">
<span class="sig-name descname"><span class="pre">plot_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">xdim</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Taweret/mix/trees.html#Trees.plot_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Taweret.mix.trees.Trees.plot_weights" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="Taweret.mix.trees.Trees.posterior">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">posterior</span></span><a class="headerlink" href="#Taweret.mix.trees.Trees.posterior" title="Permalink to this definition"></a></dt>
<dd><p>Stores the most recent posteriors from running self.train function</p>
<dl class="simple">
<dt>_posterior<span class="classifier">np.ndarray</span></dt><dd><p>posterior from learning the weights</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Taweret.mix.trees.Trees.predict">
<span class="sig-name descname"><span class="pre">predict</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.68</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Taweret/mix/trees.html#Trees.predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Taweret.mix.trees.Trees.predict" title="Permalink to this definition"></a></dt>
<dd><p>Evaluate posterior to make prediction at test points.</p>
<dl class="simple">
<dt>evaluated_posterior<span class="classifier">np.ndarray</span></dt><dd><p>array of posterior predictive distribution evaluated at provided
test points</p>
</dd>
<dt>mean<span class="classifier">np.ndarray</span></dt><dd><p>average mixed model value at each provided test points</p>
</dd>
<dt>credible_intervals<span class="classifier">np.ndarray</span></dt><dd><p>intervals corresponding for 60%, 90% credible intervals</p>
</dd>
<dt>std_dev<span class="classifier">np.ndarray</span></dt><dd><p>sample standard deviation of mixed model output at provided test
points</p>
</dd>
</dl>
<p>Global liner mixing:</p>
<p><a href="#id17"><span class="problematic" id="id18">``</span></a><a href="#id19"><span class="problematic" id="id20">`</span></a>python
class MyMixer(BaseMixer):</p>
<blockquote>
<div><p>. . .
def predict(self, x_test):</p>
<blockquote>
<div><p># work to calculate everything
. . .
return posterior, means, credible_intervals, std_dev</p>
</div></blockquote>
</div></blockquote>
<p><a href="#id21"><span class="problematic" id="id22">``</span></a><a href="#id23"><span class="problematic" id="id24">`</span></a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Taweret.mix.trees.Trees.predict_sigma">
<span class="sig-name descname"><span class="pre">predict_sigma</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.68</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Taweret/mix/trees.html#Trees.predict_sigma"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Taweret.mix.trees.Trees.predict_sigma" title="Permalink to this definition"></a></dt>
<dd></dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Taweret.mix.trees.Trees.predict_weights">
<span class="sig-name descname"><span class="pre">predict_weights</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ci</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.68</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Taweret/mix/trees.html#Trees.predict_weights"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Taweret.mix.trees.Trees.predict_weights" title="Permalink to this definition"></a></dt>
<dd><p>Calculate posterior predictive distribution for model weights</p>
<dl class="simple">
<dt>evaluated_posterior<span class="classifier">np.ndarray</span></dt><dd><p>array of posterior predictive distribution evaluated at provided
test points</p>
</dd>
<dt>mean<span class="classifier">np.ndarray</span></dt><dd><p>average mixed model value at each provided test points</p>
</dd>
<dt>credible_intervals<span class="classifier">np.ndarray</span></dt><dd><p>intervals corresponding for 60%, 90% credible intervals</p>
</dd>
<dt>std_dev<span class="classifier">np.ndarray</span></dt><dd><p>sample standard deviation of mixed model output at provided test
points</p>
</dd>
</dl>
<p>Global liner mixing:</p>
<p><a href="#id25"><span class="problematic" id="id26">``</span></a><a href="#id27"><span class="problematic" id="id28">`</span></a>python
class MyMixer(BaseMixer):</p>
<blockquote>
<div><p>. . .
def predict_weights(self, x_test):</p>
<blockquote>
<div><p># work to calculate everything
. . .
return posterior, means, credible_intervals, std_dev</p>
</div></blockquote>
</div></blockquote>
<p><a href="#id29"><span class="problematic" id="id30">``</span></a><a href="#id31"><span class="problematic" id="id32">`</span></a></p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="Taweret.mix.trees.Trees.prior">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">prior</span></span><a class="headerlink" href="#Taweret.mix.trees.Trees.prior" title="Permalink to this definition"></a></dt>
<dd><p>Dictionary of prior distributions. Format should be compatible with
sampler.</p>
<dl class="simple">
<dt>_prior<span class="classifier">Dict[str, Any]</span></dt><dd><p>Underlying prior object(s)</p>
</dd>
</dl>
<p>Please consult <cite>BaseMixer.set_prior</cite> for an example</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Taweret.mix.trees.Trees.prior_predict">
<span class="sig-name descname"><span class="pre">prior_predict</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/Taweret/mix/trees.html#Trees.prior_predict"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Taweret.mix.trees.Trees.prior_predict" title="Permalink to this definition"></a></dt>
<dd><p>Get prior predictive distribution and prior distribution samples
Returns:
--------
evaluated_prior : np.ndarray</p>
<blockquote>
<div><p>array of prior predictive distribution evaluated at provided
test points</p>
</div></blockquote>
<dl class="simple">
<dt>mean<span class="classifier">np.ndarray</span></dt><dd><p>average mixed model value at each provided test points</p>
</dd>
<dt>credible_intervals<span class="classifier">np.ndarray</span></dt><dd><p>intervals corresponding for 60%, 90% credible intervals</p>
</dd>
<dt>std_dev<span class="classifier">np.ndarray</span></dt><dd><p>sample standard deviation of mixed model output at provided test
points</p>
</dd>
</dl>
<p>Global liner mixing:</p>
<p><a href="#id33"><span class="problematic" id="id34">``</span></a><a href="#id35"><span class="problematic" id="id36">`</span></a>python
class MyMixer(BaseMixer):</p>
<blockquote>
<div><p>. . .
def prior_predict(self, x_test):</p>
<blockquote>
<div><p># work to calculate everything
. . .
return prior, means, credible_intervals, std_dev</p>
</div></blockquote>
</div></blockquote>
<p><a href="#id37"><span class="problematic" id="id38">``</span></a><a href="#id39"><span class="problematic" id="id40">`</span></a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Taweret.mix.trees.Trees.set_prior">
<span class="sig-name descname"><span class="pre">set_prior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">prior_dict</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Taweret/mix/trees.html#Trees.set_prior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Taweret.mix.trees.Trees.set_prior" title="Permalink to this definition"></a></dt>
<dd><p>User must provide function that sets a member varibale called _prior.
Dictionary of prior distributions. Format should be compatible with
sampler.</p>
<p><a href="#id41"><span class="problematic" id="id42">``</span></a><a href="#id43"><span class="problematic" id="id44">`</span></a>python
class MyMixer(BaseMixer):</p>
<blockquote>
<div><p>. . .
def set_prior(self, prior_dict):</p>
<blockquote>
<div><p>self._prior = prior_dict</p>
</div></blockquote>
<p>. . .</p>
</div></blockquote>
<p># creating a bilby prior dict
priors = dict()
priors['a'] = bilby.core.prior.MultivariateGaussian(mvg, 'a')
priors['b'] = bilby.core.prior.MultivariateGaussian(mvg, 'b')
m = MyMixer()
m.set_prior(prior_dict=priors)
<a href="#id45"><span class="problematic" id="id46">``</span></a><a href="#id47"><span class="problematic" id="id48">`</span></a></p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="Taweret.mix.trees.Trees.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">X</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/Taweret/mix/trees.html#Trees.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#Taweret.mix.trees.Trees.train" title="Permalink to this definition"></a></dt>
<dd><p>Run sampler to learn parameters. Method should also create class
members that store the posterior and other diagnostic quantities
import for plotting
MAP values should also caluclate and set as member variable of
class</p>
<dl class="simple">
<dt>_posterior<span class="classifier">np.ndarray</span></dt><dd><p>the mcmc chain return from sampler</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="Taweret.core.html" class="btn btn-neutral float-left" title="Taweret.core namespace" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="Taweret.models.html" class="btn btn-neutral float-right" title="Taweret.models namespace" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, Dan Liyanage, Alexandra Semposki.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>